<!-- product-popup-form.liquid -->
<div id="product-popup" class="product-popup hidden">
  <div class="product-popup__overlay"></div>
  <div class="product-popup__content">
    <button class="product-popup__close">×</button>
    <form id="product-popup-form" action="/cart/add" method="post">
      <input type="hidden" name="id" id="product-popup-product-id">

      <!-- Size Selection -->
      <div class="product-popup__field">
        <label for="size">Välj ett alternativ</label>
        <select id="size" name="properties[Size]">
          {% assign size_options = '' %}
          {% for variant in product.variants %}
            {% if size_options contains variant.option1 %}
              {% continue %}
            {% endif %}
            <option value="{{ variant.option1 }}">{{ variant.option1 }}</option>
            {% assign size_options = size_options | append: variant.option1 | append: ',' %}
          {% endfor %}
        </select>
      </div>

      <button type="submit" class="button button--primary">Bäställ</button>
      <button type="button" class="button button--secondary product-popup__cancel">Cancel</button>
    </form>
  </div>
</div>

<style>
  .hidden { display: none; }
  .product-popup { position: fixed; top: 0; left: 0; width: 100%; height: 100%; }
  .product-popup__overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); }
  .product-popup__content { position: relative; margin: 100px auto; padding: 20px; background: #fff; width: 80%; max-width: 500px; }
  .product-popup__close { position: absolute; top: 10px; right: 10px; border: none; background: none; font-size: 24px; cursor: pointer; }
  .product-popup__field { margin-bottom: 15px; }
</style>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var popupTrigger = document.querySelector('.button--primary');
    var popup = document.getElementById('product-popup');
    var closeButton = document.querySelector('.product-popup__close');

    if (popupTrigger && popup && closeButton) {
      popupTrigger.addEventListener('click', function(e) {
        e.preventDefault();
        popup.style.display = 'block';
      });

      closeButton.addEventListener('click', function(e) {
        e.preventDefault();
        popup.style.display = 'none';
      });

      window.addEventListener('click', function(e) {
        if (e.target === popup) {
          popup.style.display = 'none';
        }
      });
    } else {
      console.error('Popup elements not found.');
    }
  });
</script>
